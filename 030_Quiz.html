<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz 030 - INNER JOIN en SAP HANA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 20px;
            position: relative;
            z-index: 1;
        }

        .stat-item {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }

        .content {
            padding: 40px;
        }

        .question-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #27ae60;
            display: none;
            transform: translateY(20px);
            opacity: 0;
            transition: all 0.5s ease;
        }

        .question-card.active {
            display: block;
            transform: translateY(0);
            opacity: 1;
        }

        .question-number {
            color: #27ae60;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .question-text {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 25px;
            line-height: 1.4;
            color: #333;
        }

        .options {
            display: grid;
            gap: 15px;
            margin-bottom: 25px;
        }

        .option {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border: 2px solid transparent;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .option:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .option.selected {
            border-color: #27ae60;
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
        }

        .option.correct {
            border-color: #4CAF50;
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
        }

        .option.incorrect {
            border-color: #f44336;
            background: linear-gradient(135deg, #f44336 0%, #da190b 100%);
            color: white;
        }

        .buttons {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .btn-primary {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .explanation {
            background: linear-gradient(135deg, #e8f5e8 0%, #f0f8f0 100%);
            border-left: 4px solid #4CAF50;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }

        .explanation.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .explanation h4 {
            color: #2e7d32;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .final-score {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            display: none;
            margin-top: 30px;
        }

        .final-score.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 2.5em;
            font-weight: bold;
            backdrop-filter: blur(10px);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            border-radius: 4px;
            transition: width 0.8s ease;
        }

        .study-tips {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            border-left: 4px solid #ff9800;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .study-tips h4 {
            color: #e65100;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .study-tips ul {
            margin-left: 20px;
        }

        .study-tips li {
            margin-bottom: 8px;
            color: #bf360c;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                margin: 0;
                border-radius: 15px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .content {
                padding: 20px;
            }
            
            .question-card {
                padding: 20px;
            }
            
            .stats {
                flex-direction: column;
                gap: 15px;
            }
            
            .stat-item {
                padding: 12px 20px;
            }
            
            .buttons {
                flex-direction: column;
            }
            
            .btn {
                padding: 12px 20px;
                font-size: 1em;
            }
            
            .question-text {
                font-size: 1.1em;
            }
            
            .option {
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5em;
            }
            
            .content {
                padding: 15px;
            }
            
            .question-card {
                padding: 15px;
            }
            
            .score-circle {
                width: 120px;
                height: 120px;
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎯 Quiz 030 | SAP HANA</h1>
            <p>INNER JOIN - El JOIN Más Estricto</p>
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-number" id="currentQuestion">1</span>
                    <span>Pregunta</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="totalQuestions">8</span>
                    <span>Total</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="score">0</span>
                    <span>Puntaje</span>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <div class="content">
            <div id="questionContainer"></div>
            
            <div class="final-score" id="finalScore">
                <div class="score-circle" id="finalScoreCircle">0%</div>
                <h2>¡Quiz Completado!</h2>
                <p id="scoreMessage"></p>
                <button class="btn btn-primary" onclick="restartQuiz()">Reiniciar Quiz</button>
            </div>
        </div>
    </div>

    <script>
        const questions = [
            {
                question: "¿Cuál es la característica principal del INNER JOIN?",
                options: [
                    "Devuelve todos los registros de ambas tablas",
                    "Solo devuelve registros que tienen coincidencias en ambas tablas",
                    "Devuelve todos los registros de la tabla izquierda",
                    "Es el JOIN más lento de todos"
                ],
                correct: 1,
                explanation: "INNER JOIN es el más selectivo de todos los JOINs. Solo devuelve registros que tienen coincidencias en ambas tablas según la condición especificada en la cláusula ON. Si un registro de cualquier tabla no tiene correspondencia, queda excluido del resultado."
            },
            {
                question: "¿Qué proceso interno realiza el INNER JOIN para generar el resultado?",
                options: [
                    "Solo busca coincidencias directas",
                    "Producto cartesiano de las tablas seguido de filtrado",
                    "Ordena las tablas y luego las une",
                    "Crea índices temporales automáticamente"
                ],
                correct: 1,
                explanation: "Internamente, INNER JOIN realiza el producto cartesiano: combina cada registro de la tabla A con cada registro de la tabla B, evalúa la condición ON para cada combinación, y luego filtra manteniendo solo las combinaciones que cumplen la condición."
            },
            {
                question: "¿Cuál es la sintaxis correcta del INNER JOIN?",
                options: [
                    "SELECT * FROM tabla1, tabla2 WHERE tabla1.id = tabla2.id",
                    "SELECT * FROM tabla1 INNER JOIN tabla2 ON tabla1.id = tabla2.id",
                    "SELECT * FROM tabla1 JOIN WITH tabla2 USING tabla1.id = tabla2.id",
                    "SELECT * INNER JOIN tabla1, tabla2 ON tabla1.id = tabla2.id"
                ],
                correct: 1,
                explanation: "La sintaxis correcta es: FROM tabla1 INNER JOIN tabla2 ON condición. Esta es la sintaxis estándar SQL moderna, recomendada y requerida en certificaciones SAP HANA. Separa claramente la unión (JOIN) de los filtros (WHERE)."
            },
            {
                question: "¿Cuándo son obligatorios los alias en INNER JOIN?",
                options: [
                    "Siempre son opcionales",
                    "Solo para consultas complejas",
                    "Cuando las tablas tienen campos con nombres idénticos",
                    "Solo en SAP HANA, no en otros sistemas"
                ],
                correct: 2,
                explanation: "Los alias son obligatorios cuando las tablas tienen campos con nombres idénticos (como 'state' en ambas tablas del ejemplo). Sin alias, obtienes error de 'columna ambigua' porque SQL no sabe a cuál campo te refieres. Los alias resuelven esta ambigüedad."
            },
            {
                question: "¿Qué sucede si un INNER JOIN no encuentra ninguna coincidencia?",
                options: [
                    "Da error y se detiene la consulta",
                    "Se ejecuta completamente pero devuelve resultado vacío",
                    "Devuelve NULL en todos los campos",
                    "Se convierte automáticamente en LEFT OUTER JOIN"
                ],
                correct: 1,
                explanation: "INNER JOIN siempre se ejecuta completamente, procesando todas las combinaciones del producto cartesiano, incluso si no devuelve resultados. Si no hay coincidencias, simplemente devuelve un resultado vacío (0 filas), pero el procesamiento interno se realiza por completo."
            },
            {
                question: "¿Por qué NO se recomienda el método WHERE para hacer JOINs?",
                options: [
                    "Es más lento que INNER JOIN",
                    "No funciona en SAP HANA",
                    "Es sintaxis obsoleta que mezcla JOINs con filtros",
                    "Solo funciona con tablas pequeñas"
                ],
                correct: 2,
                explanation: "El método WHERE es sintaxis obsoleta que mezcla las uniones entre tablas con los filtros de datos, reduciendo la legibilidad. La sintaxis INNER JOIN es el estándar actual, mejora la legibilidad, separa propósitos claramente y es requerida en certificaciones SAP."
            },
            {
                question: "Si tienes una tabla con 100 registros y otra con 50 registros, ¿cuántas combinaciones evalúa internamente el INNER JOIN?",
                options: [
                    "150 combinaciones (100 + 50)",
                    "5,000 combinaciones (100 × 50)",
                    "Solo las que coinciden",
                    "Depende del número de coincidencias"
                ],
                correct: 1,
                explanation: "INNER JOIN evalúa todas las combinaciones del producto cartesiano: 100 × 50 = 5,000 combinaciones. Internamente procesa todas estas combinaciones para evaluar la condición ON, y luego filtra mostrando solo las que cumplen la condición. Por esto los índices son cruciales para el rendimiento."
            },
            {
                question: "¿Cuál es la principal ventaja del INNER JOIN sobre otros tipos de JOIN?",
                options: [
                    "Es más fácil de escribir",
                    "Funciona con cualquier tipo de datos",
                    "Produce resultados limpios sin valores NULL y tiene óptimo rendimiento",
                    "Permite unir más de dos tablas"
                ],
                correct: 2,
                explanation: "INNER JOIN produce resultados limpios sin valores NULL por falta de relación, ya que solo incluye registros con correspondencia completa. Además, generalmente tiene el mejor rendimiento entre los JOINs debido a su naturaleza restrictiva. Es ideal para análisis que requieren datos completos y verificados."
            }
        ];

        let currentQuestionIndex = 0;
        let userAnswers = [];
        let score = 0;

        function initQuiz() {
            displayQuestion();
            updateProgress();
        }

        function displayQuestion() {
            const container = document.getElementById('questionContainer');
            const question = questions[currentQuestionIndex];
            
            container.innerHTML = `
                <div class="question-card active">
                    <div class="question-number">Pregunta ${currentQuestionIndex + 1} de ${questions.length}</div>
                    <div class="question-text">${question.question}</div>
                    <div class="options" id="options">
                        ${question.options.map((option, index) => `
                            <div class="option" onclick="selectOption(${index})" data-index="${index}">
                                <strong>${String.fromCharCode(65 + index)})</strong> ${option}
                            </div>
                        `).join('')}
                    </div>
                    <div class="explanation" id="explanation">
                        <h4>💡 Explicación:</h4>
                        <p>${question.explanation}</p>
                    </div>
                    <div class="buttons">
                        <button class="btn btn-secondary" onclick="previousQuestion()" ${currentQuestionIndex === 0 ? 'disabled' : ''}>
                            ← Anterior
                        </button>
                        <button class="btn btn-primary" onclick="submitAnswer()" id="submitBtn" disabled>
                            Confirmar Respuesta
                        </button>
                        <button class="btn btn-primary" onclick="nextQuestion()" id="nextBtn" style="display: none;">
                            ${currentQuestionIndex === questions.length - 1 ? 'Ver Resultados' : 'Siguiente →'}
                        </button>
                    </div>
                </div>
            `;
            
            // Restore previous answer if exists
            if (userAnswers[currentQuestionIndex] !== undefined) {
                selectOption(userAnswers[currentQuestionIndex]);
                submitAnswer();
            }
        }

        function selectOption(index) {
            const options = document.querySelectorAll('.option');
            options.forEach(option => option.classList.remove('selected'));
            options[index].classList.add('selected');
            
            document.getElementById('submitBtn').disabled = false;
        }

        function submitAnswer() {
            const selectedOption = document.querySelector('.option.selected');
            if (!selectedOption) return;
            
            const selectedIndex = parseInt(selectedOption.dataset.index);
            const question = questions[currentQuestionIndex];
            
            userAnswers[currentQuestionIndex] = selectedIndex;
            
            const options = document.querySelectorAll('.option');
            options.forEach((option, index) => {
                option.onclick = null;
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedIndex && index !== question.correct) {
                    option.classList.add('incorrect');
                }
            });
            
            document.getElementById('explanation').classList.add('show');
            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'block';
        }

        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                updateProgress();
            } else {
                showFinalScore();
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
                updateProgress();
            }
        }

        function updateProgress() {
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            // Update score
            score = userAnswers.filter((answer, index) => answer === questions[index].correct).length;
            document.getElementById('score').textContent = score;
        }

        function showFinalScore() {
            const finalScore = Math.round((score / questions.length) * 100);
            
            document.getElementById('questionContainer').style.display = 'none';
            document.getElementById('finalScore').classList.add('show');
            document.getElementById('finalScoreCircle').textContent = finalScore + '%';
            
            let message = '';
            if (finalScore >= 80) {
                message = '🎉 ¡Excelente! Dominas perfectamente el INNER JOIN y estás listo para consultas complejas.';
            } else if (finalScore >= 60) {
                message = '👍 Buen trabajo. Repasa los conceptos del proceso interno y uso de alias.';
            } else {
                message = '📚 Necesitas repasar los fundamentos del INNER JOIN antes de avanzar.';
            }
            
            document.getElementById('scoreMessage').innerHTML = `
                <p>${message}</p>
                <div class="study-tips">
                    <h4>🎯 Puntos clave para dominar INNER JOIN:</h4>
                    <ul>
                        <li><strong>Máxima selectividad:</strong> Solo registros con coincidencias en ambas tablas</li>
                        <li><strong>Sintaxis estándar:</strong> FROM tabla1 INNER JOIN tabla2 ON condición</li>
                        <li><strong>Proceso interno:</strong> Producto cartesiano + filtrado de coincidencias</li>
                        <li><strong>Alias obligatorios:</strong> Para resolver campos ambiguos (mismo nombre)</li>
                        <li><strong>Siempre se ejecuta:</strong> Procesa todas las combinaciones, devuelva o no resultados</li>
                        <li><strong>Resultados limpios:</strong> No aparecen valores NULL por falta de relación</li>
                        <li><strong>Óptimo rendimiento:</strong> Generalmente el JOIN más rápido</li>
                        <li><strong>Método recomendado:</strong> Usar INNER JOIN, no WHERE para uniones</li>
                        <li><strong>Escalabilidad:</strong> n × m combinaciones (importante para optimización)</li>
                        <li><strong>Casos de uso:</strong> Datos relacionados obligatorios, reportes de integridad</li>
                    </ul>
                </div>
            `;
        }

        function restartQuiz() {
            currentQuestionIndex = 0;
            userAnswers = [];
            score = 0;
            
            document.getElementById('questionContainer').style.display = 'block';
            document.getElementById('finalScore').classList.remove('show');
            
            initQuiz();
        }

        // Initialize quiz when page loads
        window.onload = initQuiz;
    </script>
</body>
</html>