<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz 032 - FULL OUTER JOIN SAP HANA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 20px;
            position: relative;
            z-index: 1;
        }

        .stat-item {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }

        .content {
            padding: 40px;
        }

        .question-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #9b59b6;
            display: none;
            transform: translateY(20px);
            opacity: 0;
            transition: all 0.5s ease;
        }

        .question-card.active {
            display: block;
            transform: translateY(0);
            opacity: 1;
        }

        .question-number {
            color: #9b59b6;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .question-text {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 25px;
            line-height: 1.4;
            color: #333;
        }

        .options {
            display: grid;
            gap: 15px;
            margin-bottom: 25px;
        }

        .option {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border: 2px solid transparent;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .option:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .option.selected {
            border-color: #9b59b6;
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
        }

        .option.correct {
            border-color: #4CAF50;
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
        }

        .option.incorrect {
            border-color: #f44336;
            background: linear-gradient(135deg, #f44336 0%, #da190b 100%);
            color: white;
        }

        .buttons {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .btn-primary {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .explanation {
            background: linear-gradient(135deg, #e8f5e8 0%, #f0f8f0 100%);
            border-left: 4px solid #4CAF50;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }

        .explanation.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .explanation h4 {
            color: #2e7d32;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .final-score {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            display: none;
            margin-top: 30px;
        }

        .final-score.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 2.5em;
            font-weight: bold;
            backdrop-filter: blur(10px);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            border-radius: 4px;
            transition: width 0.8s ease;
        }

        .study-tips {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            border-left: 4px solid #ff9800;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .study-tips h4 {
            color: #e65100;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .study-tips ul {
            margin-left: 20px;
        }

        .study-tips li {
            margin-bottom: 8px;
            color: #bf360c;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                margin: 0;
                border-radius: 15px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .content {
                padding: 20px;
            }
            
            .question-card {
                padding: 20px;
            }
            
            .stats {
                flex-direction: column;
                gap: 15px;
            }
            
            .stat-item {
                padding: 12px 20px;
            }
            
            .buttons {
                flex-direction: column;
            }
            
            .btn {
                padding: 12px 20px;
                font-size: 1em;
            }
            
            .question-text {
                font-size: 1.1em;
            }
            
            .option {
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5em;
            }
            
            .content {
                padding: 15px;
            }
            
            .question-card {
                padding: 15px;
            }
            
            .score-circle {
                width: 120px;
                height: 120px;
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔄 Quiz 032 | SAP HANA</h1>
            <p>FULL OUTER JOIN - El JOIN Más Inclusivo</p>
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-number" id="currentQuestion">1</span>
                    <span>Pregunta</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="totalQuestions">8</span>
                    <span>Total</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="score">0</span>
                    <span>Puntaje</span>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <div class="content">
            <div id="questionContainer"></div>
            
            <div class="final-score" id="finalScore">
                <div class="score-circle" id="finalScoreCircle">0%</div>
                <h2>¡Quiz Completado!</h2>
                <p id="scoreMessage"></p>
                <button class="btn btn-primary" onclick="restartQuiz()">Reiniciar Quiz</button>
            </div>
        </div>
    </div>

    <script>
        const questions = [
            {
                question: "¿Qué representa el FULL OUTER JOIN en términos de otros tipos de JOIN?",
                options: [
                    "Es idéntico al INNER JOIN pero más rápido",
                    "Combina los efectos de LEFT OUTER JOIN y RIGHT OUTER JOIN",
                    "Solo funciona con tablas que tienen relaciones perfectas",
                    "Es una versión optimizada del RIGHT OUTER JOIN"
                ],
                correct: 1,
                explanation: "FULL OUTER JOIN actúa como si uniéramos los efectos del LEFT OUTER JOIN y del RIGHT OUTER JOIN. Muestra todos los registros de ambas tablas, independientemente de que tengan o no correspondencia."
            },
            {
                question: "¿Cuál es la sintaxis correcta del FULL OUTER JOIN?",
                options: [
                    "SELECT * FROM tabla1 FULL JOIN tabla2 ON condición",
                    "SELECT * FROM tabla1 FULL OUTER JOIN tabla2 ON condición",
                    "SELECT * FROM tabla1 OUTER FULL JOIN tabla2 ON condición",
                    "SELECT * FROM tabla1 COMPLETE JOIN tabla2 ON condición"
                ],
                correct: 1,
                explanation: "La sintaxis correcta es 'FULL OUTER JOIN'. Debe incluir ambas palabras 'FULL' y 'OUTER' seguidas de 'JOIN', manteniendo la estructura estándar de SQL con la condición ON."
            },
            {
                question: "Con nuestros datos de ejemplo (4 clientes: Werner-MI, Mark-MI, Tom-TX, Bob-TX y 2 estados: MI-Michigan, AL-Alabama), ¿cuántos registros produce el FULL OUTER JOIN?",
                options: [
                    "2 registros (solo las coincidencias)",
                    "4 registros (todos los clientes)",
                    "3 registros (clientes válidos + estados sin clientes)",
                    "5 registros (todos los clientes + todos los estados)"
                ],
                correct: 3,
                explanation: "FULL OUTER JOIN produce 5 registros: Werner-MI, Mark-MI, Tom-NULL, Bob-NULL, NULL-Alabama. Incluye todos los clientes (incluso los que tienen estado TX inexistente) y todos los estados (incluso Alabama que no tiene clientes)."
            },
            {
                question: "¿Cuál es la principal diferencia entre LEFT OUTER JOIN y FULL OUTER JOIN?",
                options: [
                    "LEFT OUTER es más rápido pero menos preciso",
                    "LEFT OUTER solo preserva la tabla izquierda, FULL OUTER preserva ambas tablas",
                    "No hay diferencias, son sinónimos",
                    "FULL OUTER solo funciona con claves primarias"
                ],
                correct: 1,
                explanation: "LEFT OUTER JOIN preserva todos los registros de la tabla izquierda solamente. FULL OUTER JOIN preserva todos los registros de AMBAS tablas, mostrando una visión completamente inclusiva."
            },
            {
                question: "¿Cómo maneja el rendimiento el FULL OUTER JOIN comparado con LEFT OUTER JOIN?",
                options: [
                    "FULL OUTER es siempre más eficiente",
                    "Ambos tienen el mismo rendimiento",
                    "FULL OUTER hace procesamiento exhaustivo y es más pesado",
                    "LEFT OUTER siempre es más lento"
                ],
                correct: 2,
                explanation: "FULL OUTER JOIN tiene rendimiento similar al RIGHT OUTER JOIN: hace siempre el JOIN completo, evalúa todas las combinaciones posibles y luego agrega registros sin correspondencia de ambos lados. Es más pesado que LEFT OUTER JOIN."
            },
            {
                question: "¿Cuál es el caso de uso más apropiado para FULL OUTER JOIN?",
                options: [
                    "Reportes diarios normales de ventas",
                    "Consultas frecuentes de análisis básico",
                    "Auditorías de integridad para detectar inconsistencias en ambas direcciones",
                    "Optimización de consultas rápidas"
                ],
                correct: 2,
                explanation: "FULL OUTER JOIN es ideal para auditorías de integridad donde necesitas detectar problemas de datos en ambas direcciones: registros huérfanos en cualquier tabla, análisis de cobertura completa y migración de datos."
            },
            {
                question: "¿Cuándo NO deberías usar FULL OUTER JOIN?",
                options: [
                    "Cuando necesitas ver todos los datos disponibles",
                    "En auditorías de migración de datos",
                    "En consultas frecuentes y análisis dirigido donde sabes que solo necesitas una perspectiva",
                    "Cuando tienes tablas pequeñas"
                ],
                correct: 2,
                explanation: "Evita FULL OUTER JOIN en consultas frecuentes, análisis dirigido donde solo necesitas una perspectiva, datos grandes donde el rendimiento es crítico, y reportes normales donde LEFT OUTER JOIN es suficiente."
            },
            {
                question: "Con FULL OUTER JOIN, ¿qué completas en términos de JOINs del SQL estándar?",
                options: [
                    "Solo una variante más de LEFT OUTER JOIN",
                    "El arsenal completo de JOINs del SQL estándar",
                    "La primera etapa de JOINs avanzados",
                    "Una versión experimental de INNER JOIN"
                ],
                correct: 1,
                explanation: "Con FULL OUTER JOIN completas todos los JOINs del SQL estándar: INNER, LEFT OUTER, RIGHT OUTER y FULL OUTER JOIN. Los demás JOINs (REFERENTIAL, TEXT, TEMPORAL, SPATIAL) pertenecen específicamente a las vistas de información de SAP HANA."
            }
        ];

        let currentQuestionIndex = 0;
        let userAnswers = [];
        let score = 0;

        function initQuiz() {
            displayQuestion();
            updateProgress();
        }

        function displayQuestion() {
            const container = document.getElementById('questionContainer');
            const question = questions[currentQuestionIndex];
            
            container.innerHTML = `
                <div class="question-card active">
                    <div class="question-number">Pregunta ${currentQuestionIndex + 1} de ${questions.length}</div>
                    <div class="question-text">${question.question}</div>
                    <div class="options" id="options">
                        ${question.options.map((option, index) => `
                            <div class="option" onclick="selectOption(${index})" data-index="${index}">
                                <strong>${String.fromCharCode(65 + index)})</strong> ${option}
                            </div>
                        `).join('')}
                    </div>
                    <div class="explanation" id="explanation">
                        <h4>🔄 Explicación:</h4>
                        <p>${question.explanation}</p>
                    </div>
                    <div class="buttons">
                        <button class="btn btn-secondary" onclick="previousQuestion()" ${currentQuestionIndex === 0 ? 'disabled' : ''}>
                            ← Anterior
                        </button>
                        <button class="btn btn-primary" onclick="submitAnswer()" id="submitBtn" disabled>
                            Confirmar Respuesta
                        </button>
                        <button class="btn btn-primary" onclick="nextQuestion()" id="nextBtn" style="display: none;">
                            ${currentQuestionIndex === questions.length - 1 ? 'Ver Resultados' : 'Siguiente →'}
                        </button>
                    </div>
                </div>
            `;
            
            // Restore previous answer if exists
            if (userAnswers[currentQuestionIndex] !== undefined) {
                selectOption(userAnswers[currentQuestionIndex]);
                submitAnswer();
            }
        }

        function selectOption(index) {
            const options = document.querySelectorAll('.option');
            options.forEach(option => option.classList.remove('selected'));
            options[index].classList.add('selected');
            
            document.getElementById('submitBtn').disabled = false;
        }

        function submitAnswer() {
            const selectedOption = document.querySelector('.option.selected');
            if (!selectedOption) return;
            
            const selectedIndex = parseInt(selectedOption.dataset.index);
            const question = questions[currentQuestionIndex];
            
            userAnswers[currentQuestionIndex] = selectedIndex;
            
            const options = document.querySelectorAll('.option');
            options.forEach((option, index) => {
                option.onclick = null;
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedIndex && index !== question.correct) {
                    option.classList.add('incorrect');
                }
            });
            
            document.getElementById('explanation').classList.add('show');
            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'block';
        }

        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                updateProgress();
            } else {
                showFinalScore();
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
                updateProgress();
            }
        }

        function updateProgress() {
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            // Update score
            score = userAnswers.filter((answer, index) => answer === questions[index].correct).length;
            document.getElementById('score').textContent = score;
        }

        function showFinalScore() {
            const finalScore = Math.round((score / questions.length) * 100);
            
            document.getElementById('questionContainer').style.display = 'none';
            document.getElementById('finalScore').classList.add('show');
            document.getElementById('finalScoreCircle').textContent = finalScore + '%';
            
            let message = '';
            if (finalScore >= 80) {
                message = '🎉 ¡Excelente! Dominas FULL OUTER JOIN y completas el arsenal de JOINs del SQL estándar.';
            } else if (finalScore >= 60) {
                message = '👍 Buen trabajo. Repasa los conceptos de inclusividad y rendimiento para perfeccionar.';
            } else {
                message = '⚠️ IMPORTANTE: Debes dominar FULL OUTER JOIN para completar tu arsenal de JOINs.';
            }
            
            document.getElementById('scoreMessage').innerHTML = `
                <p>${message}</p>
                <div class="study-tips">
                    <h4>🔄 Puntos críticos para dominar FULL OUTER JOIN:</h4>
                    <ul>
                        <li><strong>Máxima inclusividad:</strong> LEFT OUTER + RIGHT OUTER = FULL OUTER JOIN</li>
                        <li><strong>Sintaxis estándar:</strong> FULL OUTER JOIN con condición ON</li>
                        <li><strong>Resultado completo:</strong> Todos los registros de ambas tablas</li>
                        <li><strong>Gestión de NULL:</strong> Completa donde no hay correspondencia</li>
                        <li><strong>Rendimiento pesado:</strong> Procesamiento exhaustivo obligatorio</li>
                        <li><strong>Casos específicos:</strong> Auditorías y análisis completos</li>
                        <li><strong>Arsenal completo:</strong> INNER + LEFT + RIGHT + FULL OUTER</li>
                        <li><strong>Uso responsable:</strong> Solo cuando necesitas vista 360°</li>
                    </ul>
                </div>
            `;
        }

        function restartQuiz() {
            currentQuestionIndex = 0;
            userAnswers = [];
            score = 0;
            
            document.getElementById('questionContainer').style.display = 'block';
            document.getElementById('finalScore').classList.remove('show');
            
            initQuiz();
        }

        // Initialize quiz when page loads
        window.onload = initQuiz;
    </script>
</body>
</html>